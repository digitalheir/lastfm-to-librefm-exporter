{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///./src/scrobbler/scrobbler_api.ts","webpack:///./src/fetch-url.ts","webpack:///./src/md5.ts","webpack:///./src/librefm.ts","webpack:///./src/browser.ts","webpack:///./src/app_synchronize.tsx"],"names":["root","factory","exports","module","define","amd","a","i","window","installedModules","__webpack_require__","moduleId","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","md5_1","fetch_url_1","urlGetToken","base_url","api_key","secret","params","urlEncodeParams","constructSignatureForParams","connectApplication","baseUrl","apiKey","cb","encodeURIComponent","map","join","createSessionUrl","token","append","data","push","appendTrack","track","artist","timestamp","toString","album","trackNumber","mbid","duration","createScrobbleFormData","tracks","sk","forEach","formData","FormData","pair","scrobbleTracks","req","makePostRequest","alert","responseText","md5hash","sort","b","sortByKey","createRequest","url","onLoad","onError","XMLHttpRequest","overrideMimeType","open","onerror","onload","makeGetRequest","send","hexcase","rstr_md5","binl2rstr","binl_md5","rstr2binl","length","rstr2hex","input","x","hex_tab","output","charCodeAt","charAt","str2rstr_utf8","y","String","fromCharCode","Array","len","olda","oldb","oldc","oldd","md5_ff","md5_gg","md5_hh","md5_ii","safe_add","md5_cmn","q","bit_rol","lsw","num","cnt","scrobbler_api_1","libreApi","libre2_0","connectApplicationLibreFm","convertToLibreScrobbles","arr","createLibreScrobble","uts","paramsRegex","decode","decodeURIComponent","replace","parseUrlParams","urlParams","query","substring","match","exec","getCurrentHostName","location","hostname","browser_1","librefm_1","mountPoint","document","getElementById","search","errorNode","message","it","createElement","innerText","paramName","_i","arguments","hasAll","k","alertParamName","librefm_api_key","librefm_secret","crSess","innerHTML","appendChild","json","JSON","parse","this","error","content","div"],"mappings":"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","file":"js/synchronize.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 16);\n","import {md5hash} from \"../md5\";\nimport {LibreScrobbleTrack} from \"../librefm\";\nimport {makePostRequest} from \"../fetch-url\";\n\nexport const urlGetToken = (base_url: string, api_key: string, secret: string) => {\n    const params = [\n        [\"method\", \"auth.getToken\"],\n        [\"api_key\", api_key],\n        // [\"format\", \"json\"],\n    ];\n    return `${base_url}?${urlEncodeParams(params)}&api_sig=${constructSignatureForParams(params, secret)}&format=json`;\n};\n\nexport const connectApplication = (baseUrl: string,\n                                   apiKey: string,\n                                   cb?: string) => `${baseUrl}auth/?api_key=${cb ? apiKey + \"&cb=\" + encodeURIComponent(cb) : apiKey}`;\n\n// export const authorizeToken = (baseUrl: string,\n//                                apiKey: string,\n//                                token: string) => `${baseUrl}auth/?api_key=${apiKey}&token=${token}`;\n\nconst urlEncodeParams = (params: string[][]) => params.map(p => `${p[0]}=${p[1]}`).join(\"&\");\n\nexport const createSessionUrl = (baseUrl: string,\n                                 apiKey: string,\n                                 token: string,\n                                 secret: string) => {\n    const params = [[\"api_key\", apiKey], [\"method\", \"auth.getSession\"], [\"token\", token],\n        // [\"format\", \"json\"]\n    ];\n    return `${baseUrl}?${urlEncodeParams(params)}&api_sig=${constructSignatureForParams(params, secret)}&format=json`;\n};\n\nconst append = function (data: string[][], key: string, value?: string) {\n    if (value) data.push([key, value]);\n};\n\nconst appendTrack = (data: string[][],\n                     track: LibreScrobbleTrack,\n                     i: number) => {\n    append(data, `artist[${i}]`, track.artist); //  (Required) : The artist name.\n    append(data, `track[${i}]`, track.track); //  (Required) : The track name.\n    append(data, `timestamp[${i}]`, track.timestamp.toString()); //  (Required) : The time the track started playing, in UNIX timestamp format (integer number of seconds since 00:00:00, January 1st 1970 UTC). This must be in the UTC time zone.\n    append(data, `album[${i}]`, track.album); //  (Optional) : The album name.\n    // append(data, `context[${i}]`, track.context); //  (Optional) : Sub-client version (not public, only enabled for certain API keys)\n    // append(data, `streamId[${i}]`, track.streamId); //  (Optional) : The stream id for this track received from the radio.getPlaylist service, if scrobbling Last.fm radio\n    // append(data, `chosenByUser[${i}]`, track.chosenByUser); //  (Optional) : Set to 1 if the user chose this song, or 0 if the song was chosen by someone else (such as a radio station or recommendation service). Assumes 1 if not specified\n    append(data, `trackNumber[${i}]`, track.trackNumber); //  (Optional) : The track number of the track on the album.\n    append(data, `mbid[${i}]`, track.mbid); //  (Optional) : The MusicBrainz Track ID.\n    // append(data, `albumArtist[${i}]`, track.albumArtist); //  (Optional) : The album artist - if this differs from the track artist.\n    append(data, `duration[${i}]`, track.duration); //  (Optional) : The length of the track in seconds.\n};\n\nexport function createScrobbleFormData(tracks: LibreScrobbleTrack[], apiKey: string, sk: string, secret: string) {\n    const data: string[][] = [];\n    tracks.forEach((track, i) => appendTrack(data, track, i));\n    const method = \"track.scrobble\";\n    data.push([\"method\", method]);\n    data.push([\"api_key\", apiKey]);\n    data.push([\"sk\", sk]); // A session key generated by authenticating a user via the authentication protocol.\n    const formData = new FormData();\n    data.forEach((pair) => formData.append(pair[0], pair[1]));\n    formData.append(\"api_sig\", constructSignatureForParams(data, secret));\n    return formData;\n}\n\nexport const scrobbleTracks = (baseUrl: string,\n                               apiKey: string,\n                               sk: string,\n                               secret: string,\n                               tracks: LibreScrobbleTrack[]) => {\n    const formData = createScrobbleFormData(tracks, apiKey, sk, secret);\n\n    const req = makePostRequest(baseUrl, formData, () => {\n        // const res = JSON.parse(req.responseText);\n        alert(req.responseText);\n    }, () => {\n        // const res = JSON.parse(req.responseText);\n        alert(req.responseText);\n    });\n};\n\n\n// 16 : The service is temporarily unavailable, please try again.\n// 2 : Invalid service - This service does not exist\n// 3 : Invalid Method - No method with that name in this package\n// 4 : Authentication Failed - You do not have permissions to access the service\n// 5 : Invalid format - This service doesn't exist in that format\n// 6 : Invalid parameters - Your request is missing a required parameter\n// 7 : Invalid resource specified\n// 8 : Operation failed - Something else went wrong\n// 9 : Invalid session key - Please re-authenticate\n// 10 : Invalid API key - You must be granted a valid key by last.fm\n// 11 : Service Offline - This service is temporarily offline. Try again later.\n// 13 : Invalid method signature supplied\n// 16 : There was a temporary error processing your request. Please try again\n// 26 : Suspended API key - Access for your account has been suspended, please contact Last.fm\n// 29 : Rate limit exceeded - Your IP has made too many requests in a short period\n\nconst constructSignature = (apiKey: string, method: string, token: string, secret: string) => md5hash(`api_key${apiKey}method${method}token${token}${secret}`);\n\nconst sortByKey = (data: string[][]) => data.sort((a, b) => a[0] < b[0] ? -1 : a[0] > b[0] ? 1 : 0);\n\nexport const constructSignatureForParams = (data: string[][], secret: string): string => md5hash(\n    `${sortByKey(data).map(pair => pair[0] + pair[1])}${secret}`);","export const createRequest = (url: string, onLoad?: () => any, onError?: () => any) => {\n    const req = new XMLHttpRequest();\n    req.overrideMimeType(\"application/json\");\n    req.open(\"GET\", url, true);\n    if (onError) {\n        req.onerror = onError;\n    }\n    if (onLoad) {\n        req.onload = onLoad;\n    }\n    return req;\n};\n\nexport const makeGetRequest = (url: string,\n                               onLoad?: (this: XMLHttpRequest, ev: ProgressEvent) => any,\n                               onError?: (this: XMLHttpRequest, ev: ProgressEvent) => any) => {\n    const req = new XMLHttpRequest();\n    req.overrideMimeType(\"application/json\");\n    req.open(\"GET\", url, true);\n    if (onError) {\n        req.onerror = onError;\n    }\n    if (onLoad) {\n        req.onload = onLoad;\n    }\n    req.send(null);\n    return req;\n};\n\nexport const makePostRequest = (url: string, data: FormData, onLoad?: () => any, onError?: () => any) => {\n    const req = new XMLHttpRequest();\n    req.overrideMimeType(\"application/json\");\n    req.open(\"POST\", url, true);\n    if (onError) {\n        req.onerror = onError;\n    }\n    if (onLoad) {\n        req.onload = onLoad;\n    }\n    req.send(data);\n    return req;\n};","const hexcase = 0;\n/* hex output format. 0 - lowercase; 1 - uppercase        */\nconst b64pad = \"\";\n/* base-64 pad character. \"=\" for strict RFC compliance   */\n\n/*\n * These are the functions you'll usually want to call\n * They take string arguments and return either hex or base-64 encoded strings\n */\nexport const md5hash = (s: string) => rstr2hex(rstr_md5(str2rstr_utf8(s)));\n\nfunction b64_md5(s) {\n    return rstr2b64(rstr_md5(str2rstr_utf8(s)));\n}\n\nfunction any_md5(s, e) {\n    return rstr2any(rstr_md5(str2rstr_utf8(s)), e);\n}\n\nfunction hex_hmac_md5(k, d) {\n    return rstr2hex(rstr_hmac_md5(str2rstr_utf8(k), str2rstr_utf8(d)));\n}\n\nfunction b64_hmac_md5(k, d) {\n    return rstr2b64(rstr_hmac_md5(str2rstr_utf8(k), str2rstr_utf8(d)));\n}\n\nfunction any_hmac_md5(k, d, e) {\n    return rstr2any(rstr_hmac_md5(str2rstr_utf8(k), str2rstr_utf8(d)), e);\n}\n\n/*\n * Calculate the MD5 of a raw string\n */\nfunction rstr_md5(s) {\n    return binl2rstr(binl_md5(rstr2binl(s), s.length * 8));\n}\n\n/*\n * Calculate the HMAC-MD5, of a key and some data (raw strings)\n */\nfunction rstr_hmac_md5(key, data) {\n    let bkey = rstr2binl(key);\n    if (bkey.length > 16) bkey = binl_md5(bkey, key.length * 8);\n\n    const ipad = Array(16), opad = Array(16);\n    for (let i = 0; i < 16; i++) {\n        ipad[i] = bkey[i] ^ 0x36363636;\n        opad[i] = bkey[i] ^ 0x5C5C5C5C;\n    }\n\n    const hash = binl_md5(ipad.concat(rstr2binl(data)), 512 + data.length * 8);\n    return binl2rstr(binl_md5(opad.concat(hash), 512 + 128));\n}\n\n/*\n * Convert a raw string to a hex string\n */\nfunction rstr2hex(input) {\n    const hex_tab = hexcase ? \"0123456789ABCDEF\" : \"0123456789abcdef\";\n    let output = \"\";\n    let x;\n    for (let i = 0; i < input.length; i++) {\n        x = input.charCodeAt(i);\n        output += hex_tab.charAt((x >>> 4) & 0x0F)\n            + hex_tab.charAt(x & 0x0F);\n    }\n    return output;\n}\n\n/*\n * Convert a raw string to a base-64 string\n */\nfunction rstr2b64(input) {\n    const tab = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\n    let output = \"\";\n    const len = input.length;\n    for (let i = 0; i < len; i += 3) {\n        const triplet = (input.charCodeAt(i) << 16)\n            | (i + 1 < len ? input.charCodeAt(i + 1) << 8 : 0)\n            | (i + 2 < len ? input.charCodeAt(i + 2) : 0);\n        for (let j = 0; j < 4; j++) {\n            if (i * 8 + j * 6 > input.length * 8) output += b64pad;\n            else output += tab.charAt((triplet >>> 6 * (3 - j)) & 0x3F);\n        }\n    }\n    return output;\n}\n\n/*\n * Convert a raw string to an arbitrary string encoding\n */\nfunction rstr2any(input, encoding) {\n    const divisor = encoding.length;\n    let i, j, q, x, quotient;\n\n    /* Convert to an array of 16-bit big-endian values, forming the dividend */\n    let dividend = Array(Math.ceil(input.length / 2));\n    for (i = 0; i < dividend.length; i++) {\n        dividend[i] = (input.charCodeAt(i * 2) << 8) | input.charCodeAt(i * 2 + 1);\n    }\n\n    /*\n     * Repeatedly perform a long division. The binary array forms the dividend,\n     * the length of the encoding is the divisor. Once computed, the quotient\n     * forms the dividend for the next step. All remainders are stored for later\n     * use.\n     */\n    const full_length = Math.ceil(input.length * 8 /\n        (Math.log(encoding.length) / Math.log(2)));\n    const remainders = Array(full_length);\n    for (j = 0; j < full_length; j++) {\n        quotient = Array();\n        x = 0;\n        for (i = 0; i < dividend.length; i++) {\n            x = (x << 16) + dividend[i];\n            q = Math.floor(x / divisor);\n            x -= q * divisor;\n            if (quotient.length > 0 || q > 0)\n                quotient[quotient.length] = q;\n        }\n        remainders[j] = x;\n        dividend = quotient;\n    }\n\n    /* Convert the remainders to the output string */\n    let output = \"\";\n    for (i = remainders.length - 1; i >= 0; i--)\n        output += encoding.charAt(remainders[i]);\n\n    return output;\n}\n\n/*\n * Encode a string as utf-8.\n * For efficiency, this assumes the input is valid utf-16.\n */\nfunction str2rstr_utf8(input) {\n    let output = \"\";\n    let i = -1;\n    let x, y;\n\n    while (++i < input.length) {\n        /* Decode utf-16 surrogate pairs */\n        x = input.charCodeAt(i);\n        y = i + 1 < input.length ? input.charCodeAt(i + 1) : 0;\n        if (0xD800 <= x && x <= 0xDBFF && 0xDC00 <= y && y <= 0xDFFF) {\n            x = 0x10000 + ((x & 0x03FF) << 10) + (y & 0x03FF);\n            i++;\n        }\n\n        /* Encode output as utf-8 */\n        if (x <= 0x7F)\n            output += String.fromCharCode(x);\n        else if (x <= 0x7FF)\n            output += String.fromCharCode(0xC0 | ((x >>> 6) & 0x1F),\n                0x80 | (x & 0x3F));\n        else if (x <= 0xFFFF)\n            output += String.fromCharCode(0xE0 | ((x >>> 12) & 0x0F),\n                0x80 | ((x >>> 6) & 0x3F),\n                0x80 | (x & 0x3F));\n        else if (x <= 0x1FFFFF)\n            output += String.fromCharCode(0xF0 | ((x >>> 18) & 0x07),\n                0x80 | ((x >>> 12) & 0x3F),\n                0x80 | ((x >>> 6) & 0x3F),\n                0x80 | (x & 0x3F));\n    }\n    return output;\n}\n\n/*\n * Encode a string as utf-16\n */\nfunction str2rstr_utf16le(input) {\n    let output = \"\";\n    for (let i = 0; i < input.length; i++)\n        output += String.fromCharCode(input.charCodeAt(i) & 0xFF,\n            (input.charCodeAt(i) >>> 8) & 0xFF);\n    return output;\n}\n\nfunction str2rstr_utf16be(input) {\n    let output = \"\";\n    for (let i = 0; i < input.length; i++)\n        output += String.fromCharCode((input.charCodeAt(i) >>> 8) & 0xFF,\n            input.charCodeAt(i) & 0xFF);\n    return output;\n}\n\nfunction rstr2binl(input) {\n    const output = Array(input.length >> 2);\n    for (let i = 0; i < output.length; i++)\n        output[i] = 0;\n    for (let i = 0; i < input.length * 8; i += 8)\n        output[i >> 5] |= (input.charCodeAt(i / 8) & 0xFF) << (i % 32);\n    return output;\n}\n\nfunction binl2rstr(input) {\n    const output = [];\n    for (let i = 0; i < input.length * 32; i += 8)\n        output.push(String.fromCharCode((input[i >> 5] >>> (i % 32)) & 0xFF));\n    return output.join(\"\");\n}\n\nfunction binl_md5(x, len) {\n    x[len >> 5] |= 0x80 << ((len) % 32);\n    x[(((len + 64) >>> 9) << 4) + 14] = len;\n\n    let a = 1732584193;\n    let b = -271733879;\n    let c = -1732584194;\n    let d = 271733878;\n\n    for (let i = 0; i < x.length; i += 16) {\n        const olda = a;\n        const oldb = b;\n        const oldc = c;\n        const oldd = d;\n\n        a = md5_ff(a, b, c, d, x[i], 7, -680876936);\n        d = md5_ff(d, a, b, c, x[i + 1], 12, -389564586);\n        c = md5_ff(c, d, a, b, x[i + 2], 17, 606105819);\n        b = md5_ff(b, c, d, a, x[i + 3], 22, -1044525330);\n        a = md5_ff(a, b, c, d, x[i + 4], 7, -176418897);\n        d = md5_ff(d, a, b, c, x[i + 5], 12, 1200080426);\n        c = md5_ff(c, d, a, b, x[i + 6], 17, -1473231341);\n        b = md5_ff(b, c, d, a, x[i + 7], 22, -45705983);\n        a = md5_ff(a, b, c, d, x[i + 8], 7, 1770035416);\n        d = md5_ff(d, a, b, c, x[i + 9], 12, -1958414417);\n        c = md5_ff(c, d, a, b, x[i + 10], 17, -42063);\n        b = md5_ff(b, c, d, a, x[i + 11], 22, -1990404162);\n        a = md5_ff(a, b, c, d, x[i + 12], 7, 1804603682);\n        d = md5_ff(d, a, b, c, x[i + 13], 12, -40341101);\n        c = md5_ff(c, d, a, b, x[i + 14], 17, -1502002290);\n        b = md5_ff(b, c, d, a, x[i + 15], 22, 1236535329);\n\n        a = md5_gg(a, b, c, d, x[i + 1], 5, -165796510);\n        d = md5_gg(d, a, b, c, x[i + 6], 9, -1069501632);\n        c = md5_gg(c, d, a, b, x[i + 11], 14, 643717713);\n        b = md5_gg(b, c, d, a, x[i], 20, -373897302);\n        a = md5_gg(a, b, c, d, x[i + 5], 5, -701558691);\n        d = md5_gg(d, a, b, c, x[i + 10], 9, 38016083);\n        c = md5_gg(c, d, a, b, x[i + 15], 14, -660478335);\n        b = md5_gg(b, c, d, a, x[i + 4], 20, -405537848);\n        a = md5_gg(a, b, c, d, x[i + 9], 5, 568446438);\n        d = md5_gg(d, a, b, c, x[i + 14], 9, -1019803690);\n        c = md5_gg(c, d, a, b, x[i + 3], 14, -187363961);\n        b = md5_gg(b, c, d, a, x[i + 8], 20, 1163531501);\n        a = md5_gg(a, b, c, d, x[i + 13], 5, -1444681467);\n        d = md5_gg(d, a, b, c, x[i + 2], 9, -51403784);\n        c = md5_gg(c, d, a, b, x[i + 7], 14, 1735328473);\n        b = md5_gg(b, c, d, a, x[i + 12], 20, -1926607734);\n\n        a = md5_hh(a, b, c, d, x[i + 5], 4, -378558);\n        d = md5_hh(d, a, b, c, x[i + 8], 11, -2022574463);\n        c = md5_hh(c, d, a, b, x[i + 11], 16, 1839030562);\n        b = md5_hh(b, c, d, a, x[i + 14], 23, -35309556);\n        a = md5_hh(a, b, c, d, x[i + 1], 4, -1530992060);\n        d = md5_hh(d, a, b, c, x[i + 4], 11, 1272893353);\n        c = md5_hh(c, d, a, b, x[i + 7], 16, -155497632);\n        b = md5_hh(b, c, d, a, x[i + 10], 23, -1094730640);\n        a = md5_hh(a, b, c, d, x[i + 13], 4, 681279174);\n        d = md5_hh(d, a, b, c, x[i], 11, -358537222);\n        c = md5_hh(c, d, a, b, x[i + 3], 16, -722521979);\n        b = md5_hh(b, c, d, a, x[i + 6], 23, 76029189);\n        a = md5_hh(a, b, c, d, x[i + 9], 4, -640364487);\n        d = md5_hh(d, a, b, c, x[i + 12], 11, -421815835);\n        c = md5_hh(c, d, a, b, x[i + 15], 16, 530742520);\n        b = md5_hh(b, c, d, a, x[i + 2], 23, -995338651);\n\n        a = md5_ii(a, b, c, d, x[i], 6, -198630844);\n        d = md5_ii(d, a, b, c, x[i + 7], 10, 1126891415);\n        c = md5_ii(c, d, a, b, x[i + 14], 15, -1416354905);\n        b = md5_ii(b, c, d, a, x[i + 5], 21, -57434055);\n        a = md5_ii(a, b, c, d, x[i + 12], 6, 1700485571);\n        d = md5_ii(d, a, b, c, x[i + 3], 10, -1894986606);\n        c = md5_ii(c, d, a, b, x[i + 10], 15, -1051523);\n        b = md5_ii(b, c, d, a, x[i + 1], 21, -2054922799);\n        a = md5_ii(a, b, c, d, x[i + 8], 6, 1873313359);\n        d = md5_ii(d, a, b, c, x[i + 15], 10, -30611744);\n        c = md5_ii(c, d, a, b, x[i + 6], 15, -1560198380);\n        b = md5_ii(b, c, d, a, x[i + 13], 21, 1309151649);\n        a = md5_ii(a, b, c, d, x[i + 4], 6, -145523070);\n        d = md5_ii(d, a, b, c, x[i + 11], 10, -1120210379);\n        c = md5_ii(c, d, a, b, x[i + 2], 15, 718787259);\n        b = md5_ii(b, c, d, a, x[i + 9], 21, -343485551);\n\n        a = safe_add(a, olda);\n        b = safe_add(b, oldb);\n        c = safe_add(c, oldc);\n        d = safe_add(d, oldd);\n    }\n    return Array(a, b, c, d);\n}\n\nconst md5_cmn = (q, a, b, x, s, t) => safe_add(bit_rol(safe_add(safe_add(a, q), safe_add(x, t)), s), b);\nconst md5_ff = (a, b, c, d, x, s, t) => md5_cmn((b & c) | ((~b) & d), a, b, x, s, t);\nconst md5_gg = (a, b, c, d, x, s, t) => md5_cmn((b & d) | (c & (~d)), a, b, x, s, t);\nconst md5_hh = (a, b, c, d, x, s, t) => md5_cmn(b ^ c ^ d, a, b, x, s, t);\nconst md5_ii = (a, b, c, d, x, s, t) => md5_cmn(c ^ (b | (~d)), a, b, x, s, t);\nconst safe_add = (x, y) => {\n    const lsw = (x & 0xFFFF) + (y & 0xFFFF);\n    return ((x >> 16) + (y >> 16) + (lsw >> 16) << 16) | (lsw & 0xFFFF);\n};\nconst bit_rol = (num, cnt) => (num << cnt) | (num >>> (32 - cnt));","import {connectApplication} from \"./scrobbler/scrobbler_api\";\nimport {Scrobble} from \"./parse_track\";\n\nexport const libreApi = \"https://libre.fm/api/\";\nexport const libre2_0 = \"https://libre.fm/2.0/\";\n\nexport const connectApplicationLibreFm = (apiKey: string) => connectApplication(libreApi, apiKey);\n\nexport interface LibreScrobbleTrack {\n    timestamp: number;\n    track: string;\n    artist: string;\n    album?: string;\n    mbid?: string;\n    duration?: string;\n    trackNumber?: string;\n}\n\nconst createLibreScrobble = (\n    timestamp: number,\n    track: string,\n    artist: string,\n    album?: string,\n    mbid?: string,\n    duration?: string,\n    trackNumber?: string): LibreScrobbleTrack => ({\n    timestamp,\n    track,\n    artist,\n    album,\n    mbid,\n    duration,\n    trackNumber,\n});\n\nexport const convertToLibreScrobbles = (arr: Scrobble[]): LibreScrobbleTrack[] => arr.map((s) =>\n    createLibreScrobble(s.uts, s.name, (s.artist && s.artist.name) || \"\", s.album && s.album.name, s.mbid, s.duration, s.trackNumber));\n\n// export const createUrl = (api_method: string,\n//                           userLastFm: string,\n//                           api_key: string,\n//                           startpage: number,\n//                           limit: number = 2) =>\n//     `${baseurl}method=${api_method}&user=${userLastFm}&api_key=${api_key}&limit=${limit}&page=${startpage}&format=json`;","const paramsRegex = /([^&=]+)=?([^&]*)/g;\nconst decode = (s: string) => decodeURIComponent(s.replace(/\\s+/g, \"\"));\n\nexport function parseUrlParams(params: string | null): any {\n    if (params) {\n        const urlParams: any = {};\n        const query = params.substring(1);\n\n        let match;\n        while (match = paramsRegex.exec(query))\n            urlParams[decode(match[1])] = decode(match[2]);\n\n        return urlParams;\n    } else return {};\n}\n\nexport const getCurrentHostName = (window: any): string => {\n    if (!window) return \"\";\n    const location = window.location;\n    if (!location) return \"\";\n    return location.hostname || \"\";\n};","// import * as React from \"react\";\n// import {render} from \"react-dom\";\n// import {App} from \"./components/App\";\nimport {parseUrlParams} from \"./browser\";\nimport {createSessionUrl} from \"./scrobbler/scrobbler_api\";\nimport {libre2_0} from \"./librefm\";\nimport {makeGetRequest} from \"./fetch-url\";\n\nconst mountPoint = document.getElementById(\"mount-point\");\nconst l = window ? window.location : null;\nconst params = parseUrlParams(l ? l.search : null);\n\nfunction alertParamName(...paramName: string[]): boolean {\n    let hasAll = true;\n    paramName.forEach((k) => {\n        if (!params[k]) {\n            alert(\"Expected parameter \" + k);\n            hasAll = false;\n        }\n    });\n    return hasAll;\n}\n\nconst a = (href: string, content: string) => {\n    const it = document.createElement(\"a\");\n    it.href = href;\n    it.innerText = content;\n    return it;\n};\n\nconst div = (content: string) => {\n    const it = document.createElement(\"div\");\n    it.innerText = content;\n    return it;\n};\n\nconst errorNode = (message: string) => {\n    const it = document.createElement(\"div\");\n    it.innerText = message;\n    return it;\n};\n\nif (alertParamName(\"lastfm_user\", \"lastfm_api_key\", \"librefm_api_key\", \"librefm_user\", \"librefm_secret\", \"token\")) {\n    if (mountPoint) {\n        // render(<App {...params}/>, mountPoint);\n        const url = createSessionUrl(libre2_0, params.librefm_api_key as string, params.token as string, params.librefm_secret as string);\n        const crSess = document.createElement(\"div\");\n        crSess.innerHTML = `Creating session (<a href=\"${url}\">${url}</a>)`;\n        mountPoint.appendChild(crSess);\n\n        makeGetRequest(url, function () {\n            const json = JSON.parse(this.responseText);\n            if (json && json.key) {\n                mountPoint.appendChild(errorNode(\"Could not create session: \" + json.error));\n            } else\n                mountPoint.appendChild(div(\"Created session with session key \" + json.key));\n        }, () => {\n            mountPoint.appendChild(errorNode(\"Could not create session\"));\n        });\n\n        // <lfm status=\"ok\">\n        //     <session>\n        //         <name>ocky7</name>\n        //         <key>0af19b3f97a91fb8c1c903de1d4f7e08</key>\n        //         <subscriber>0</subscriber>\n        //     </session>\n        // </lfm>\n        //mountPoint.appendChild(a(url, url));\n    }\n}\n"],"sourceRoot":""}